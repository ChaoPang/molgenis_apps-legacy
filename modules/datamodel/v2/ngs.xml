<?xml version="1.0" encoding="UTF-8"?>
<molgenis name="org.molgenis" label="Next Generation Sequencing">
	<module name="ngs">
		<description>Extension to Observ-OM to support Next Gen Sequencing
			projects
			using the Illumina platform. Each work consists of NgsStudy
			having
			one or more NgsSample. These samples are then put on a
			FlowcellLane, optionally with barcode.
		</description>
		<entity name="NgsStudy" extends="Study">
			<description>An NgsProject bundles information about one study
			</description>
			<field name="NoLanes" type="int"
				description="Number of lanes planned in this study" nillable="true" />
			<field name="NoSamples" type="int"
				description="Number of samples planned in this study" nillable="true" />
			<field name="SeqType" type="enum" enum_options="[SingleEnd,PairedEnd,MatePair]" />
		</entity>
		<entity name="NgsSample" extends="ObservationTarget">
			<description>Description of the sample/library</description>
			<field name="sampletype" type="enum" default="dna"
				enum_options="[dna,rna]"
				description="Type of sample (dna/rna). Will become ontologyReference" />
			<field name="description" type="text" readonly="true" nillable="true"
				description="Description/Notes about the sample" />
			<field name="AlternativeIds" type="mref" xref_entity="Accession"
				nillable="true"
				description="(Optional) alternative accession numbers. E.g. arrayexpress:M-EXP-2345" />
			<unique fields="identifier" description="Identifier is globally unique" />
		</entity>
		<entity name="Flowcell" extends="ObservationTarget">
			<description> A Flowcell is a unit of measuremnt, currently, 8 lanes
				measurement on the Illumina Genome Analyzer
			</description>
			<field name="machine" type="xref" xref_entity="Machine"
				description="The Illumina machine it was run on" />
			<field name="run" nillable="false"
				description="The run number (string), always use 4 digits (with leading 0's)" />
			<field name="runDate" type="date" nillable="true"
				description="The date the flowcell was run on the machine" />
		</entity>
		<entity name="LibraryLane" extends="ObservationTarget" decorator="org.molgenis.ngs.decorators.LibraryLaneDecorator">
			<description>This is actually our worksheet. Name is typically
				library name, or of there is only one sample per library it may be
				sample name. Description of the sample library that has been
				measured
				on a flowcell. A lane is one lane on the Illumina Genome
				Analyzer. At this point, the library entity is not traced
				seperately. Optionally, a sample is barcoded.
			</description>
			<!-- override identifier to become an automatic value of flowcell_lane_barcode-->
			<field name="identifier" auto="true" default="autogenerated" readonly="true"/>
			<field name="flowcell" type="xref" xref_entity="Flowcell"
				description="The flowcell to which this lane belongs" />
			<field name="lane" type="enum" enum_options="[1,2,3,4,5,6,7,8]"
				description="The lane number that is unique within a flow cell. In range 1-8" />
			<field name="barcode" type="xref" xref_entity="LibraryBarcode"
				nillable="true" description="multiple samples can be on one flowcell using barcodes" />
			<field name="sample" type="xref" xref_entity="NgsSample"
				description="The sample which is measured on this lane+library combination." />
			<field name="prepKit" type="xref" xref_entity="LibraryPrepKit"
				nillable="true" description="capturing kit used." />				
			<field name="capturing" type="xref" xref_entity="LibraryCapturing"
				nillable="true" description="capturing kit used." />
			<unique fields="flowcell,lane,barcode" description="Lane and barcode is unique per flowcell" />
		</entity>
		<entity name="LibraryBarcode" implements="Autoid" xref_label="barcode">
			<field name="barcode" type="string" unique="true"
				description="The nucleotide sequence which forms the barcode" />
			<field name="barcodeType" type="enum" enum_options="[GAF,RPI]"/>
		</entity>
		<entity name="LibraryCapturing" implements="Autoid" xref_label="capturing">
			<field name="capturing" type="string" unique="true" />
		</entity>
		<entity name="LibraryPrepKit" implements="Autoid" xref_label="prepKit">
			<field name="prepKit" type="string" unique="true" />
		</entity>
		<entity name="Machine" implements="Autoid" xref_label="machine">
			<field name="machine" type="string" unique="true" />
		</entity>
	</module>
</molgenis>